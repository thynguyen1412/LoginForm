<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>To-Do List - Christmas Theme</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-green-50 min-h-screen flex flex-col justify-between">
    <!-- Header -->
    <header class="bg-red-600 text-white py-4 shadow-md">
      <div class="container mx-auto text-center">
        <h1 class="text-4xl font-bold">üéÑ C√ÅC C√îNG VI·ªÜC C·∫¶N L√ÄM üéÖ</h1>
        <p class="mt-2 text-lg">L√™n k·∫ø ho·∫°ch cho m·ªôt Gi√°ng Sinh th·∫≠t vui v·∫ª!</p>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow">
      <div class="container mx-auto p-6">
        <form
          id="task-form"
          class="flex flex-wrap gap-4 justify-center items-center"
        >
          <input
            id="task-input"
            type="text"
            placeholder="Th√™m c√¥ng vi·ªác..."
            class="flex-grow p-3 border rounded border-green-500 placeholder-green-400 focus:ring-2 focus:ring-green-500"
          />
          <select
            id="task-category"
            class="p-3 border rounded border-red-500 bg-red-50"
          >
            <option value="English">Ti·∫øng Anh</option>
            <option value="Coding">L·∫≠p tr√¨nh</option>
          </select>
          <button
            type="submit"
            class="bg-red-500 text-white px-4 py-3 rounded hover:bg-red-600 transition-all"
          >
            Th√™m
          </button>
        </form>

        <div
          id="tasks-container"
          class="mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
        >
          <!-- Hi·ªÉn th·ªã danh s√°ch c√¥ng vi·ªác -->
        </div>

        <!-- Close Button -->
        <div class="mt-10 text-center">
          <button
            id="close-button"
            class="bg-red-500 text-white px-6 py-3 rounded hover:bg-red-600 transition-all"
          >
            ƒê√≥ng Trang
          </button>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="bg-red-600 text-white py-4">
      <div class="container mx-auto text-center">
        <p class="text-sm">
          Ch√∫c b·∫°n c√≥ m·ªôt Gi√°ng Sinh an l√†nh v√† h·∫°nh ph√∫c! üéÑ
        </p>
      </div>
    </footer>
    <script>
      const API_URL = "https://675283dfd1983b9597b66bc1.mockapi.io/api/bai4"; // Thay b·∫±ng URL c·ªßa Mock API.

      // Th√™m c√¥ng vi·ªác v√†o Mock API
      async function addTaskToAPI(task) {
        try {
          const response = await fetch(API_URL, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(task),
          });
          if (!response.ok) {
            throw new Error("L·ªói khi th√™m c√¥ng vi·ªác v√†o API");
          }
          return await response.json();
        } catch (error) {
          console.error("L·ªói:", error);
          alert("Kh√¥ng th·ªÉ th√™m c√¥ng vi·ªác v√†o API.");
        }
      }

      // X·ª≠ l√Ω s·ª± ki·ªán submit form
      document
        .getElementById("task-form")
        .addEventListener("submit", async function (e) {
          e.preventDefault(); // NgƒÉn tr√¨nh duy·ªát t·∫£i l·∫°i trang khi form ƒë∆∞·ª£c submit

          // L·∫•y gi√° tr·ªã t·ª´ input v√† select
          const taskInput = document.getElementById("task-input");
          const taskCategory = document.getElementById("task-category");

          const taskText = taskInput.value.trim();
          const taskCat = taskCategory.value;

          // Ki·ªÉm tra input r·ªóng
          if (taskText === "") {
            alert("Vui l√≤ng nh·∫≠p c√¥ng vi·ªác.");
            return;
          }

          // T·∫°o d·ªØ li·ªáu c√¥ng vi·ªác
          const newTask = {
            text: taskText,
            category: taskCat,
          };

          // G·ª≠i c√¥ng vi·ªác m·ªõi l√™n Mock API
          const savedTask = await addTaskToAPI(newTask);
          if (!savedTask) return; // D·ª´ng n·∫øu kh√¥ng th·ªÉ l∆∞u c√¥ng vi·ªác

          // T·∫°o ph·∫ßn t·ª≠ c√¥ng vi·ªác m·ªõi trong giao di·ªán
          const taskElement = document.createElement("div");
          taskElement.className =
            "p-4 border rounded shadow bg-white flex flex-col gap-2";

          taskElement.innerHTML = `
          <h3 class="text-lg font-semibold">${savedTask.text}</h3>
          <p class="text-sm text-red-500">Ch·ªß ƒë·ªÅ: ${savedTask.category}</p>
          <button class="text-sm text-red-600 hover:underline remove-task">X√≥a</button>
        `;

          // Th√™m s·ª± ki·ªán x√≥a
          taskElement
            .querySelector(".remove-task")
            .addEventListener("click", function () {
              taskElement.remove();
            });

          // Th√™m ph·∫ßn t·ª≠ c√¥ng vi·ªác v√†o danh s√°ch
          document.getElementById("tasks-container").appendChild(taskElement);

          // X√≥a input sau khi th√™m
          taskInput.value = "";
          taskInput.focus();
        });

      // N√∫t ƒë√≥ng trang
      document
        .getElementById("close-button")
        .addEventListener("click", function () {
          window.close(); // ƒê√≥ng tab hi·ªán t·∫°i
        });
    </script>
  </body>
</html>
